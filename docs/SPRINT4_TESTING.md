# üß™ SPRINT 4 - TESTING MANUAL

## üìã RESUMEN DEL SPRINT

**Sprint:** Sprint 4 - Mejorar UX de Resultados y Men√∫s
**Fecha:** Octubre 2025
**Features Implementadas:** 5 principales

### ‚úÖ Features Completadas

1. **Edici√≥n inline de cantidades** - Botones +/- directos
2. **Drag & Drop para reordenar** - Reorganizar productos arrastrando
3. **Men√∫ semanal visual** - Calendario interactivo
4. **Impresi√≥n/Exportaci√≥n PDF** - Configuraci√≥n de opciones
5. **Notas por producto** - Comentarios personalizados

---

## üéØ CASOS DE PRUEBA

### FASE 1: Edici√≥n Inline de Cantidades

#### TC-1.1: Incrementar Cantidad
**Objetivo:** Verificar que el bot√≥n + incrementa la cantidad correctamente

**Pasos:**
1. Ir a ResultsPage con una lista generada
2. Localizar un producto
3. Click en bot√≥n "+" de QuantityControls
4. Verificar cambios

**Resultado Esperado:**
- ‚úÖ Cantidad aumenta en 1
- ‚úÖ Precio total se actualiza correctamente
- ‚úÖ Animaci√≥n smooth del cambio
- ‚úÖ Presupuesto total actualizado en header

---

#### TC-1.2: Decrementar Cantidad
**Objetivo:** Verificar que el bot√≥n - decrementa la cantidad correctamente

**Pasos:**
1. Ir a ResultsPage con una lista
2. Localizar producto con cantidad > 1
3. Click en bot√≥n "-"
4. Verificar cambios

**Resultado Esperado:**
- ‚úÖ Cantidad disminuye en 1
- ‚úÖ Precio total se actualiza
- ‚úÖ Si cantidad llega a 0, no permite m√°s decrementos
- ‚úÖ Presupuesto total actualizado

---

#### TC-1.3: Eliminar Producto
**Objetivo:** Verificar eliminaci√≥n con bot√≥n X

**Pasos:**
1. Ir a ResultsPage
2. Click en bot√≥n "X" rojo en QuantityControls
3. Confirmar eliminaci√≥n en di√°logo

**Resultado Esperado:**
- ‚úÖ Producto desaparece de la lista
- ‚úÖ Animaci√≥n de salida smooth
- ‚úÖ Contador de productos actualizado
- ‚úÖ Presupuesto recalculado
- ‚úÖ Si lista queda vac√≠a, mostrar mensaje apropiado

---

#### TC-1.4: Vista Responsive Mobile
**Objetivo:** Verificar que controles funcionan en m√≥vil

**Pasos:**
1. Abrir DevTools, modo m√≥vil (375px)
2. Verificar layout de QuantityControls
3. Probar +/- y X

**Resultado Esperado:**
- ‚úÖ Botones con tama√±o t√°ctil apropiado (min 44x44px)
- ‚úÖ Layout en columna en mobile, fila en desktop
- ‚úÖ Texto legible, sin solapamiento
- ‚úÖ Controles accesibles sin scroll horizontal

---

### FASE 2: Drag & Drop para Reordenar

#### TC-2.1: Activar Modo Reordenar
**Objetivo:** Verificar transici√≥n a vista drag & drop

**Pasos:**
1. Ir a ResultsPage
2. Click en bot√≥n "Modo Reordenar" (icono List)
3. Observar cambios

**Resultado Esperado:**
- ‚úÖ Vista cambia a lista plana (sin categor√≠as)
- ‚úÖ Handles de drag (GripVertical) visibles
- ‚úÖ Bot√≥n se actualiza a "Vista Categor√≠as"
- ‚úÖ Productos ordenables aparecen correctamente

---

#### TC-2.2: Arrastrar Producto
**Objetivo:** Verificar funcionalidad de drag & drop

**Pasos:**
1. Activar modo reordenar
2. Arrastrar un producto por el handle (GripVertical)
3. Soltarlo en otra posici√≥n
4. Verificar orden

**Resultado Esperado:**
- ‚úÖ Producto se arrastra visualmente
- ‚úÖ Otros productos se desplazan para hacer espacio
- ‚úÖ Al soltar, producto queda en nueva posici√≥n
- ‚úÖ Orden se persiste en localStorage
- ‚úÖ Animaciones fluidas

---

#### TC-2.3: Restaurar Orden Original
**Objetivo:** Verificar bot√≥n de reset

**Pasos:**
1. Reordenar varios productos
2. Click en "Restaurar Orden" (RotateCcw)
3. Confirmar acci√≥n

**Resultado Esperado:**
- ‚úÖ Productos vuelven a orden alfab√©tico/original
- ‚úÖ Orden custom eliminado de localStorage
- ‚úÖ Toast notification confirma reset
- ‚úÖ Animaci√≥n de reordenamiento

---

#### TC-2.4: Persistencia de Orden
**Objetivo:** Verificar que orden se guarda entre sesiones

**Pasos:**
1. Reordenar productos
2. Refrescar p√°gina (F5)
3. Volver a ResultsPage

**Resultado Esperado:**
- ‚úÖ Orden personalizado se mantiene
- ‚úÖ Bot√≥n "Restaurar Orden" sigue activo
- ‚úÖ LocalStorage contiene `productOrder_userId`

---

#### TC-2.5: Drag en Mobile
**Objetivo:** Verificar drag & drop en t√°ctil

**Pasos:**
1. Modo m√≥vil en DevTools
2. Activar modo reordenar
3. Simular touch drag (o usar mouse)

**Resultado Esperado:**
- ‚úÖ Handle visible y t√°ctil
- ‚úÖ Drag inicia con 8px de threshold
- ‚úÖ Feedback visual durante drag
- ‚úÖ Drop funciona correctamente

---

### FASE 3: Men√∫ Semanal Visual

#### TC-3.1: Visualizar Men√∫ Semanal
**Objetivo:** Verificar renderizado del calendario

**Pasos:**
1. Generar lista con IA que incluya men√∫ semanal
2. Ir a ResultsPage
3. Scroll hacia abajo al men√∫

**Resultado Esperado:**
- ‚úÖ Calendario de 7 d√≠as visible
- ‚úÖ Cada d√≠a en tarjeta individual (DayCard)
- ‚úÖ Nombre del d√≠a en header (Lunes, Martes...)
- ‚úÖ Comidas agrupadas por tipo (Desayuno, Comida, Cena)
- ‚úÖ Layout grid responsive (1 col mobile, 2-3 desktop)

---

#### TC-3.2: Verificar MealTags
**Objetivo:** Verificar etiquetas de comida

**Pasos:**
1. Examinar un d√≠a con m√∫ltiples comidas
2. Verificar MealTag de cada comida

**Resultado Esperado:**
- ‚úÖ Desayuno: emoji ‚òï, fondo naranja
- ‚úÖ Comida: emoji üçΩÔ∏è, fondo verde
- ‚úÖ Cena: emoji üåô, fondo √≠ndigo
- ‚úÖ Tags legibles y est√©ticos

---

#### TC-3.3: Men√∫ con D√≠as Vac√≠os
**Objetivo:** Verificar comportamiento con d√≠as sin men√∫

**Pasos:**
1. Generar lista con men√∫ incompleto (ej: solo 3 d√≠as)
2. Ver calendario

**Resultado Esperado:**
- ‚úÖ D√≠as vac√≠os muestran mensaje "Sin men√∫ asignado"
- ‚úÖ Layout no se rompe
- ‚úÖ Tarjeta con estilo apropiado (gris, no error)

---

#### TC-3.4: Responsive Men√∫ Semanal
**Objetivo:** Verificar adaptaci√≥n a diferentes pantallas

**Pasos:**
1. Ver men√∫ en mobile (375px)
2. Ver en tablet (768px)
3. Ver en desktop (1280px)

**Resultado Esperado:**
- ‚úÖ Mobile: 1 columna, scroll vertical
- ‚úÖ Tablet: 2 columnas
- ‚úÖ Desktop: 3 columnas, grid compacto
- ‚úÖ Texto legible en todos los tama√±os

---

### FASE 4: Impresi√≥n y Exportaci√≥n PDF

#### TC-4.1: Abrir Modal de Exportaci√≥n
**Objetivo:** Verificar apertura del modal

**Pasos:**
1. Ir a ResultsPage
2. Click en "Exportar" (Download icon)
3. Click en "Imprimir / PDF"

**Resultado Esperado:**
- ‚úÖ ExportOptionsModal aparece
- ‚úÖ Animaci√≥n Framer Motion smooth
- ‚úÖ Overlay oscuro detr√°s
- ‚úÖ Modal centrado y responsive

---

#### TC-4.2: Configurar Opciones
**Objetivo:** Verificar checkboxes de configuraci√≥n

**Pasos:**
1. Abrir modal exportaci√≥n
2. Toggle "Incluir precios"
3. Toggle "Incluir men√∫ semanal"

**Resultado Esperado:**
- ‚úÖ Checkboxes visualmente claros
- ‚úÖ Estado persiste durante sesi√≥n
- ‚úÖ Labels descriptivos
- ‚úÖ Funcionalidad de toggle suave

---

#### TC-4.3: Imprimir con react-to-print
**Objetivo:** Verificar impresi√≥n directa

**Pasos:**
1. Configurar opciones (precios ON, men√∫ ON)
2. Click en "Imprimir"
3. Inspeccionar vista previa de impresi√≥n

**Resultado Esperado:**
- ‚úÖ Di√°logo de impresi√≥n del navegador aparece
- ‚úÖ Contenido formateado para A4
- ‚úÖ Productos agrupados por categor√≠a
- ‚úÖ Checkboxes ‚òê para marcar manualmente
- ‚úÖ Precios mostrados (si configurado)
- ‚úÖ Men√∫ semanal en p√°gina aparte (si configurado)
- ‚úÖ Footer con fecha y "ListaGPT"

---

#### TC-4.4: Descargar PDF con jsPDF
**Objetivo:** Verificar generaci√≥n de PDF

**Pasos:**
1. Configurar opciones (precios ON, men√∫ OFF)
2. Click en "Descargar PDF"
3. Abrir PDF descargado

**Resultado Esperado:**
- ‚úÖ PDF se descarga autom√°ticamente
- ‚úÖ Nombre: `Lista_de_Compra_ListaGPT.pdf`
- ‚úÖ Header con nombre de lista
- ‚úÖ Metadata: personas, d√≠as, fecha
- ‚úÖ Tablas con productos por categor√≠a
- ‚úÖ Columnas: Checkbox | Producto | Cant | Precio/ud | Total
- ‚úÖ Paginaci√≥n autom√°tica si contenido largo
- ‚úÖ Footer con "P√°gina X de Y"

---

#### TC-4.5: Opciones de Exportaci√≥n (Precios OFF)
**Objetivo:** Verificar que opciones se aplican

**Pasos:**
1. Configurar "Incluir precios" = OFF
2. Descargar PDF
3. Verificar contenido

**Resultado Esperado:**
- ‚úÖ Tabla NO muestra columnas de precio
- ‚úÖ Solo: Checkbox | Producto | Cantidad
- ‚úÖ Layout ajustado correctamente
- ‚úÖ Informaci√≥n coherente

---

#### TC-4.6: Opciones de Exportaci√≥n (Men√∫ ON)
**Objetivo:** Verificar inclusi√≥n de men√∫

**Pasos:**
1. Configurar "Incluir men√∫ semanal" = ON
2. Descargar PDF
3. Verificar contenido

**Resultado Esperado:**
- ‚úÖ Men√∫ semanal en secci√≥n separada
- ‚úÖ T√≠tulo "Men√∫ Semanal"
- ‚úÖ Grid 2 columnas con d√≠as
- ‚úÖ Comidas agrupadas por d√≠a
- ‚úÖ Formato legible

---

#### TC-4.7: Excel Exportation (Legacy)
**Objetivo:** Verificar que Excel sigue funcionando

**Pasos:**
1. Click en "Exportar"
2. Click en "Exportar Excel"

**Resultado Esperado:**
- ‚úÖ Archivo .xlsx se descarga
- ‚úÖ Formato correcto
- ‚úÖ Compatibilidad con Excel/Google Sheets

---

### FASE 5: Notas por Producto

#### TC-5.1: A√±adir Nota a Producto
**Objetivo:** Verificar creaci√≥n de nota

**Pasos:**
1. Ir a ResultsPage
2. Click en icono FileText (gris) junto a nombre de producto
3. Modal ProductNoteModal aparece
4. Escribir nota: "Comprar ecol√≥gico"
5. Click en "Guardar"

**Resultado Esperado:**
- ‚úÖ Modal se abre con animaci√≥n
- ‚úÖ Producto nombre en header del modal
- ‚úÖ TextArea autofocus
- ‚úÖ Al guardar, modal se cierra
- ‚úÖ Toast notification: "Nota a√±adida"
- ‚úÖ Icono FileText cambia a azul
- ‚úÖ Nota aparece debajo del nombre (azul, italic)
- ‚úÖ Texto: "üìù Comprar ecol√≥gico"

---

#### TC-5.2: Editar Nota Existente
**Objetivo:** Verificar edici√≥n de nota

**Pasos:**
1. Producto con nota existente
2. Click en icono FileText (azul)
3. Modal muestra nota actual
4. Modificar texto: "Sin lactosa, marca X"
5. Guardar

**Resultado Esperado:**
- ‚úÖ Modal pre-relleno con nota actual
- ‚úÖ Texto editable
- ‚úÖ Al guardar, nota actualizada
- ‚úÖ Toast: "Nota a√±adida"
- ‚úÖ Visualizaci√≥n actualizada

---

#### TC-5.3: Eliminar Nota
**Objetivo:** Verificar eliminaci√≥n de nota

**Pasos:**
1. Producto con nota
2. Click en FileText
3. Click en "Eliminar Nota" (rojo)
4. Verificar cambios

**Resultado Esperado:**
- ‚úÖ Nota desaparece
- ‚úÖ Toast: "Nota eliminada"
- ‚úÖ Icono vuelve a gris
- ‚úÖ Texto de nota no visible

---

#### TC-5.4: Shortcut Ctrl+Enter
**Objetivo:** Verificar atajo de teclado

**Pasos:**
1. Abrir modal de nota
2. Escribir texto
3. Presionar Ctrl+Enter

**Resultado Esperado:**
- ‚úÖ Nota se guarda (igual que click en Guardar)
- ‚úÖ Modal se cierra
- ‚úÖ Cambios aplicados

---

#### TC-5.5: Notas en Modo Reordenar
**Objetivo:** Verificar notas en drag & drop

**Pasos:**
1. A√±adir nota a producto
2. Activar modo reordenar
3. Verificar visualizaci√≥n

**Resultado Esperado:**
- ‚úÖ Bot√≥n FileText visible en DraggableProductItem
- ‚úÖ Nota mostrada debajo del nombre
- ‚úÖ Funcionalidad id√©ntica
- ‚úÖ Click en bot√≥n abre modal

---

#### TC-5.6: Notas en Impresi√≥n
**Objetivo:** Verificar notas en PrintableList

**Pasos:**
1. A√±adir notas a 2-3 productos
2. Imprimir lista
3. Verificar vista previa

**Resultado Esperado:**
- ‚úÖ Nota visible debajo de "Cantidad:"
- ‚úÖ Formato: "üìù Nota del usuario"
- ‚úÖ Color azul (text-blue-700)
- ‚úÖ Italic
- ‚úÖ Layout limpio

---

#### TC-5.7: Notas en PDF
**Objetivo:** Verificar notas en PDF generado

**Pasos:**
1. A√±adir notas a productos
2. Descargar PDF
3. Abrir y verificar

**Resultado Esperado:**
- ‚úÖ Nota en fila adicional debajo del producto
- ‚úÖ Formato: "üìù Nota"
- ‚úÖ Sin checkbox, cantidad, ni precio en fila de nota
- ‚úÖ Tabla coherente y legible

---

#### TC-5.8: Persistencia de Notas
**Objetivo:** Verificar que notas se guardan

**Pasos:**
1. A√±adir notas a productos
2. Guardar lista
3. Recargar p√°gina
4. Volver a lista desde Historial

**Resultado Esperado:**
- ‚úÖ Notas se mantienen
- ‚úÖ Persistidas en data_json de Supabase
- ‚úÖ Iconos FileText en estado correcto (azul)
- ‚úÖ Visualizaci√≥n id√©ntica

---

### INTEGRACI√ìN Y REGRESI√ìN

#### TC-INT-1: Flujo Completo Usuario
**Objetivo:** Simular uso real completo

**Pasos:**
1. Generar lista con IA (incluir men√∫)
2. Editar cantidades con +/-
3. A√±adir notas a 3 productos
4. Activar modo reordenar y reorganizar
5. Restaurar orden
6. Descargar PDF con precios y men√∫
7. Guardar lista
8. Ir a Historial
9. Reabrir lista
10. Verificar todo se mantiene

**Resultado Esperado:**
- ‚úÖ Todas las funcionalidades trabajan juntas
- ‚úÖ Sin errores en consola
- ‚úÖ Datos persistentes correctamente
- ‚úÖ UX fluida

---

#### TC-INT-2: Modo Compra + Notas
**Objetivo:** Verificar compatibilidad con Sprint 3

**Pasos:**
1. Lista con notas a√±adidas
2. Activar modo compra (checkbox)
3. Marcar productos como comprados

**Resultado Esperado:**
- ‚úÖ Notas visibles incluso con productos tachados
- ‚úÖ Bot√≥n FileText accesible
- ‚úÖ No conflictos visuales

---

#### TC-INT-3: Favoritos + Reordenar
**Objetivo:** Verificar interacci√≥n con favoritos

**Pasos:**
1. A√±adir productos favoritos
2. Incluir en lista
3. Reordenar lista
4. Verificar favoritos

**Resultado Esperado:**
- ‚úÖ Productos favoritos mantienen estado
- ‚úÖ Estrella visible en drag & drop
- ‚úÖ Funcionalidad independiente

---

#### TC-INT-4: Dark Mode
**Objetivo:** Verificar todas las features en dark mode

**Pasos:**
1. Activar dark mode
2. Probar:
   - QuantityControls
   - Drag & drop
   - Men√∫ semanal
   - Modal exportaci√≥n
   - Modal de notas

**Resultado Esperado:**
- ‚úÖ Todos los componentes visibles
- ‚úÖ Contraste apropiado
- ‚úÖ Sin texto ilegible
- ‚úÖ Colores consistentes con dark mode

---

## üìä MATRIZ DE COBERTURA

| Feature | Componentes | Tests | Estado |
|---------|-------------|-------|--------|
| Edici√≥n Inline | QuantityControls | 4 | ‚úÖ |
| Drag & Drop | DraggableProductList, DraggableProductItem, useDragAndDrop | 5 | ‚úÖ |
| Men√∫ Semanal | WeeklyMenuCalendar, DayCard, MealTag | 4 | ‚úÖ |
| Print/Export | PrintableList, ExportOptionsModal, generatePDF | 7 | ‚úÖ |
| Notas | ProductNoteModal | 8 | ‚úÖ |
| Integraci√≥n | - | 4 | ‚úÖ |
| **TOTAL** | **10 componentes** | **32 casos** | ‚úÖ |

---

## üêõ ERRORES CONOCIDOS Y LIMITACIONES

### Limitaciones Actuales

1. **Drag & Drop en Mobile Safari:**
   - Puede tener peque√±os retrasos en iOS Safari
   - Alternativa: usar keyboard navigation (accesibilidad)

2. **Impresi√≥n en Chrome vs Firefox:**
   - Chrome: margin predeterminado puede variar
   - Soluci√≥n: ajustar en di√°logo de impresi√≥n

3. **PDF con Listas Muy Grandes (>100 productos):**
   - Paginaci√≥n autom√°tica funciona, pero puede ser lento
   - Considerar dividir lista o filtrar

4. **Notas Muy Largas:**
   - No hay l√≠mite de caracteres
   - Layout puede romperse si nota > 200 caracteres
   - Recomendaci√≥n: limitar a 150 caracteres (futuro)

---

## ‚úÖ CHECKLIST PRE-DEPLOY

Antes de marcar Sprint 4 como completo, verificar:

- [ ] Todos los 32 tests pasan
- [ ] Sin errores TypeScript (`npx tsc --noEmit`)
- [ ] Sin warnings en build (`npm run build`)
- [ ] Sin errores en consola del navegador
- [ ] Responsive funciona en: 375px, 768px, 1280px
- [ ] Dark mode OK en todas las features
- [ ] Persistencia de datos verificada (localStorage + Supabase)
- [ ] Features compatibles con Sprint 1, 2, 3
- [ ] Documentaci√≥n actualizada
- [ ] Commit messages descriptivos

---

## üöÄ CRITERIOS DE ACEPTACI√ìN

### Feature 1: Edici√≥n Inline
- ‚úÖ +/- actualiza cantidad instant√°neamente
- ‚úÖ Precio total recalcula autom√°ticamente
- ‚úÖ Bot√≥n X elimina con confirmaci√≥n
- ‚úÖ Responsive mobile

### Feature 2: Drag & Drop
- ‚úÖ Modo toggle funciona
- ‚úÖ Arrastrar reordena productos
- ‚úÖ Restaurar orden funciona
- ‚úÖ Orden persiste entre sesiones
- ‚úÖ Touch drag funciona en m√≥vil

### Feature 3: Men√∫ Semanal
- ‚úÖ Calendario renderiza 7 d√≠as
- ‚úÖ Comidas agrupadas por tipo
- ‚úÖ MealTags con colores correctos
- ‚úÖ Responsive grid

### Feature 4: Print/Export
- ‚úÖ Modal con opciones configurable
- ‚úÖ Imprimir abre di√°logo navegador
- ‚úÖ PDF descarga correctamente
- ‚úÖ Opciones se aplican (precios, men√∫)
- ‚úÖ Formato profesional A4

### Feature 5: Notas
- ‚úÖ Modal a√±ade/edita/elimina notas
- ‚úÖ Notas visibles inline (azul, italic)
- ‚úÖ Icono FileText cambia color seg√∫n estado
- ‚úÖ Shortcut Ctrl+Enter funciona
- ‚úÖ Notas en impresi√≥n y PDF
- ‚úÖ Persistencia correcta

---

## üìù NOTAS FINALES

### Tiempo Estimado de Testing Manual
- **Testing b√°sico (smoke test):** 30 min
- **Testing completo (32 casos):** 2-3 horas
- **Testing de regresi√≥n:** 1 hora

### Herramientas Recomendadas
- Chrome DevTools (Responsive mode)
- React DevTools
- Supabase Dashboard (verificar data_json)
- PDF reader (Adobe, Preview, etc.)

### Pr√≥ximos Pasos Post-Testing
1. Marcar `s4-testing` como completado
2. Verificar deploy en Vercel
3. Testing en producci√≥n con usuario real
4. Crear Sprint 5 o iterar mejoras

---

**Documento creado:** Octubre 2025  
**√öltima actualizaci√≥n:** Fase 5 completada  
**Versi√≥n:** 1.0

